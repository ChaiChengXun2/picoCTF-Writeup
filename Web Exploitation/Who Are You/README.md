# CTF Challenge Writeup
**Name:** Who Are You
**Points:** 100
**Category:** Web Exploitation

## Objective

The objective of this challenge is to gain access to a website by correctly configuring HTTP headers to meet specific requirements set by the server.

## Solution

### Method 1: Manipulating HTTP Headers

1. **Understanding HTTP Headers**
   - HTTP headers are important pieces of metadata sent between a web client (your browser) and a web server. They convey information about the request, the client, and the server's response.

2. **Initial Website Message**
   - When you first launch the website, you'll receive a message stating, "Only people who are using picobrowser can use the website." This hints at the necessity of changing your ```user-agent``` to ```picobrowser```.

3. **User-Agent Header**
   - Modify your ```user-agent``` in the HTTP headers to ```picobrowser```. This will grant you access to the next part of the challenge.

4. **Referer Header**
   - After changing the user-agent, you'll encounter a message: "I don't trust users visiting from another site." This indicates a need to set the ```Referer``` header to ```http://mercury.picoctf.net:1270/```.

5. **Date Header**
   - Upon fixing the referer header, you'll be greeted with, "Sorry, this site only worked in 2018." Adjust the ```Date``` header to ```Wed, 21 Oct 2018 07:28:00 GMT``` to proceed.
   - Any date, month and time will work. As long as the year is in ```2018```. I just copied the date, month and time from an example http date header I found online. 

6. **DNT Header**
   - Next, you'll encounter, "I don't trust users who can be tracked." Search for the HTTP header that deals with tracking, and you'll find the ```DNT``` (Do Not Track) header. Set it to ```1```.

7. **X-Forwarded-For Header**
   - The message, "This website is only for people from Sweden," seems related to an IP address. However, it's the ```X-Forwarded-For``` header that needs to be set to ```102.177.146.1```. 
   - Any Swedish public IP address will work, I chose ```102.177.146.1``` because it is the first one I encountered.

8. **Accept-Language Header**
   - Finally, you'll be asked, "You are in Sweden, but you don't speak Swedish?" Set the ```Accept-Language``` header to ```en-US,en;q=0.9, sv-SE```.
   - I basically addded ```sv-SE``` on the default ```en-US,en;q=0.9```.

### Method 2: Python Script

1. **Using Python Script**
   - Alternatively, you can achieve this programmatically using Python. The provided script sends an HTTP GET request to the target URL with the necessary headers.

2. **HTTP Headers in Python**
   - The script sets various HTTP headers including "User-Agent," "Referer," "Date," "DNT," "X-Forwarded-For," and "Accept-Language."

3. **Extracting the Flag**
   - After making the request, the script extracts the flag from the response text and prints it.

    ```
    import requests 
    
    url = "http://mercury.picoctf.net:1270/"
    
    headers = {
    	"User-Agent": "PicoBrowser",
    	"Referer": "http://mercury.picoctf.net:1270/",
    	"Date": "Wed, 21 Oct 2018 07:28:00 GMT",
    	"DNT": "1",
    	"X-Forwarded-For": "102.177.146.1",
    	"Accept-Language": "en-US,en;q=0.9, sv-SE"
    }
    
    r = requests.get(url, headers=headers)
    flag = (r.text).split(" ")[63]
    
    print(flag.split(" ")[0].replace("welcome</h3>\n\t\t\t</div>\n\t\t</div>\n\t\t<br/>\n\t\t\n\t\t\t<b>", "").replace("</b>\n\t\t\n\t</div>\n", ""))
    ```

## Flag
The flag for the Who Are You challenge is `picoCTF{XXXXX}`. Replace 'XXXXX' with the actual flag you obtained after configuring the required HTTP headers.

Congratulations on completing this Web Exploitation challenge! You've demonstrated your skills in manipulating HTTP headers to access a restricted website.
