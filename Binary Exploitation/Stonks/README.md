# Stonks  

## Basic Information  
Category: Binary Exploitation    
Points: 20   

## Solving
The objective of this challenge is to gain familiarity with format string attacks.  

Upon reviewing the source code, I identified a vulnerable call to printf. Directly calling printf on user inputs is risky, as it can potentially leak stack values. To exploit this vulnerability and retrieve the flag from the stack, I employed a format string attack.  

The vulnerable code snippet is as follows:  

```c
printf(user_buf);
```   

Using the format specifier ```%x```, I extracted values from the stack. I retrieved approximately 200 stack values, even though this quantity wasn't necessary for the solution. The following format string was used:  

```
%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|%x|...
```   

I utilised the vertical bar character,  ```|```, as a visual delimiter to separate the printed stack values, making identification easier. The output looked something like this:   

```
8470470|804b000|80489c3|f7f86d80|ffffffff|1|846e160|...
```  

To obtain the flag, I converted these hexadecimal values into ASCII characters. You can perform this conversion using online tools like [convert hex to ASCII here](https://www.rapidtables.com/convert/number/hex-to-ascii.html).  

The flag is embedded within the binary. By eliminating unnecessary portions and reversing the hidden flag, the challenge can be successfully completed.  

Flag: picoCTF{I_l05t_4ll_my_m0n3y_bdc425ea}   

Alternatively, you can utilise the provided Python script to solve the challenge, automating the process without manual decoding.  


**Challenge Solved**  
